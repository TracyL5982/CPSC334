# Pebble ESP32S3 Documentation

## Overview
Unique SERVICE_UUID is used to communicated to ESP32S3 via BLT. 
CHARACTERISTIC_UUID is used to distinguish different actions on the ESP32S3: pressing the button to notify, or initiate the vibrator motor. 
Both ids are generated by uuidgenerator.net and hardcoded to be consistent. 

```cpp
#include <Arduino.h>
#include <BLEDevice.h>
#include <BLEServer.h>

// SERVICE_UUID: unique device id for both iOS frontend and AWS backend to recognize
// CHARACTERISTIC_UUI: for iOS frontend to recognize only, to tell vibration apart from pressiong button

#define SERVICE_UUID "12345678-1234-5678-1234-56789abcdef0"
#define CHARACTERISTIC_UUID "abcdef12-3456-789a-bcde-f0123456789a"

#define BUTTON_PIN 2
#define VIBRATOR_PIN 5

BLECharacteristic *pCharacteristic;
bool isButtonPressed = false;

void setup() {
  pinMode(BUTTON_PIN, INPUT_PULLUP);
  pinMode(VIBRATOR_PIN, OUTPUT);

  BLEDevice::init("MissYouDevice");
  BLEServer *pServer = BLEDevice::createServer();
  BLEService *pService = pServer->createService(SERVICE_UUID);
  pCharacteristic = pService->createCharacteristic(
      CHARACTERISTIC_UUID,
      BLECharacteristic::PROPERTY_READ |
      BLECharacteristic::PROPERTY_WRITE |
      BLECharacteristic::PROPERTY_NOTIFY);

  pService->start();
  BLEAdvertising *pAdvertising = BLEDevice::getAdvertising();
  pAdvertising->start();
}

void loop() {
  if (digitalRead(BUTTON_PIN) == LOW) {
    if (!isButtonPressed) {
      isButtonPressed = true;
      pCharacteristic->setValue("button_pressed");
      pCharacteristic->notify(); 
      delay(300); 
    }
  } else {
    isButtonPressed = false;
  }

  if (pCharacteristic->getValue() == "vibrate") {
    digitalWrite(VIBRATOR_PIN, HIGH);
    delay(200); // Quick buzz
    digitalWrite(VIBRATOR_PIN, LOW);
    pCharacteristic->setValue(""); 
  }
}
```